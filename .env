# =============================================================================
# Local Development Environment Configuration
# =============================================================================
# This file contains configuration for the local development environment.
# Copy this file to .env.local and customize as needed.
#
# Usage:
#   cp .env.local.example .env.local
#   # Edit .env.local with your preferences
#   docker compose up  # Automatically uses .env.local if present
#
# Note: Docker Compose loads .env by default. To use .env.local, either:
#   1. Rename it to .env, OR
#   2. Use: docker compose --env-file .env.local up
# =============================================================================

# -----------------------------------------------------------------------------
# Environment Identification
# -----------------------------------------------------------------------------
ENVIRONMENT=local
COMPOSE_PROJECT_NAME=app

# -----------------------------------------------------------------------------
# Application Versions (Automatically read from source files)
# -----------------------------------------------------------------------------
# These versions are automatically extracted from:
#   - BACKEND_VERSION: backend/config/__init__.py (__version__)
#   - FRONTEND_VERSION: frontend/package.json (version)
# You can override them here if needed for testing specific versions
BACKEND_VERSION=1.0.0
FRONTEND_VERSION=1.0.0

# -----------------------------------------------------------------------------
# Port Configuration (Local Development)
# -----------------------------------------------------------------------------
# These ports are exposed on your host machine for direct access
PROXY_PORT=80
BACKEND_PORT=8001
FRONTEND_PORT=5173
DB_PORT=5432
REDIS_PORT=6379

# -----------------------------------------------------------------------------
# Database Configuration (Local Development)
# -----------------------------------------------------------------------------
# Simple credentials for local development only
DB_NAME=backend_db
DB_USER=postgres
DB_PASSWORD=postgres
DB_HOST=db
DB_PORT=5432

# PostgreSQL tuning (optional)
POSTGRES_SHARED_BUFFERS=128MB
POSTGRES_EFFECTIVE_CACHE_SIZE=512MB
POSTGRES_MAX_CONNECTIONS=50

# -----------------------------------------------------------------------------
# Redis Configuration (Local Development)
# -----------------------------------------------------------------------------
# No password for local development
REDIS_PASSWORD=
REDIS_MAXMEMORY=256mb

# -----------------------------------------------------------------------------
# Application Version
# -----------------------------------------------------------------------------
APP_VERSION=1.0.0-local

# -----------------------------------------------------------------------------
# Image Configuration (Local Development)
# -----------------------------------------------------------------------------
# Use local build, not registry images
BACKEND_IMAGE=backend-dev:latest
FRONTEND_IMAGE=frontend-dev:latest

# -----------------------------------------------------------------------------
# Worker Configuration (Local Development)
# -----------------------------------------------------------------------------
# Lower concurrency for local development
CELERY_WORKER_CONCURRENCY=2
GUNICORN_WORKERS=2

# -----------------------------------------------------------------------------
# Feature Flags (Local Development)
# -----------------------------------------------------------------------------
# Enable development features
ENABLE_DEBUG_TOOLBAR=true
ENABLE_SILK_PROFILING=true
ENABLE_HOT_RELOAD=true

# -----------------------------------------------------------------------------
# Notes
# -----------------------------------------------------------------------------
# - These settings are for LOCAL DEVELOPMENT ONLY
# - DO NOT use these settings in staging or production
# - Credentials are intentionally simple for ease of development
# - All services are exposed on host ports for debugging tools

# -----------------------------------------------------------------------------
# Port Exposure Configuration
# -----------------------------------------------------------------------------
# These variables control port exposure for development
# In local development, ports are exposed for direct access
# In staging/production, only proxy ports are exposed (via overlay files)
BACKEND_PORT_EXPOSE=8001
FRONTEND_PORT_EXPOSE=5173
DB_PORT_EXPOSE=5432
REDIS_PORT_EXPOSE=6379

# -----------------------------------------------------------------------------
# Build and Runtime Configuration
# -----------------------------------------------------------------------------
BUILD_TARGET=development
DJANGO_SETTINGS_ENV=development
NODE_ENV=development
DEBUG=True
LOG_LEVEL=INFO

# Django Secret Key (for local development only)
SECRET_KEY=django-insecure-docker-development-key-replace-in-production-with-secure-key

# Security (Disabled for local development)
SECURE_SSL_REDIRECT=False
SESSION_COOKIE_SECURE=False
CSRF_COOKIE_SECURE=False
SECURE_HSTS_SECONDS=0

# Allowed Hosts and CORS
ALLOWED_HOSTS=localhost,127.0.0.1,backend
CORS_ALLOWED_ORIGINS=http://localhost,http://127.0.0.1,http://localhost:5173
CSRF_TRUSTED_ORIGINS=http://localhost,http://127.0.0.1

# Frontend Runtime Configuration
FRONTEND_API_URL=http://localhost
FRONTEND_APP_NAME=Training Application
FRONTEND_ENABLE_DEBUG=true
FRONTEND_ENABLE_ANALYTICS=false
FRONTEND_API_ENABLE_LOGGING=true

# Vite Configuration
VITE_API_URL=http://localhost
VITE_DEBUG=true

# Restart Policy
RESTART_POLICY=unless-stopped

# Health Check Configuration
HEALTHCHECK_INTERVAL=10s
HEALTHCHECK_START_PERIOD=30s

# Resource Limits (Relaxed for local development)
DB_CPU_LIMIT=2
DB_MEMORY_LIMIT=1G
BACKEND_CPU_LIMIT=2
BACKEND_MEMORY_LIMIT=2G
FRONTEND_CPU_LIMIT=2
FRONTEND_MEMORY_LIMIT=2G

# Logging
LOG_MAX_SIZE=10m
LOG_MAX_FILE=3
LOG_COMPRESS=false

# Nginx Configuration
NGINX_CONFIG=./nginx/nginx.conf
