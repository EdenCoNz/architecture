# Story 12.1 - Architecture Diagrams

## Network Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                        â”‚
â”‚                        External Network (Host)                         â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚  Port 80 (HTTP)
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Docker Bridge Network                           â”‚
â”‚                            (app-network)                                â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  Nginx Reverse Proxy (app-proxy)                                â”‚  â”‚
â”‚  â”‚  Container: nginx:1.27-alpine                                   â”‚  â”‚
â”‚  â”‚  Port: 80 â†’ 80                                                  â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  Health: wget http://localhost/health                           â”‚  â”‚
â”‚  â”‚  Resources: 0.5 CPU, 256MB RAM                                  â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  Routes:                                                         â”‚  â”‚
â”‚  â”‚    /           â†’ frontend:5173                                  â”‚  â”‚
â”‚  â”‚    /api/*      â†’ backend:8000                                   â”‚  â”‚
â”‚  â”‚    /admin/*    â†’ backend:8000                                   â”‚  â”‚
â”‚  â”‚    /static/*   â†’ backend:8000                                   â”‚  â”‚
â”‚  â”‚    /media/*    â†’ backend:8000                                   â”‚  â”‚
â”‚  â”‚    /ws         â†’ frontend:5173 (WebSocket)                      â”‚  â”‚
â”‚  â”‚    /@vite/*    â†’ frontend:5173 (Dev assets)                     â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚                                                   â”‚            â”‚
â”‚       â”‚ HTTP Proxy                                        â”‚ HTTP Proxy â”‚
â”‚       â”‚                                                   â”‚            â”‚
â”‚       â–¼                                                   â–¼            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         â”‚              â”‚                      â”‚   â”‚
â”‚  â”‚  Frontend               â”‚              â”‚  Backend             â”‚   â”‚
â”‚  â”‚  (app-frontend)         â”‚              â”‚  (app-backend)       â”‚   â”‚
â”‚  â”‚                         â”‚              â”‚                      â”‚   â”‚
â”‚  â”‚  Image: frontend-dev    â”‚              â”‚  Image: backend-dev  â”‚   â”‚
â”‚  â”‚  Port: 5173             â”‚              â”‚  Port: 8000          â”‚   â”‚
â”‚  â”‚                         â”‚              â”‚                      â”‚   â”‚
â”‚  â”‚  Tech: React/Vite       â”‚              â”‚  Tech: Django/DRF    â”‚   â”‚
â”‚  â”‚  Node: 20-alpine        â”‚              â”‚  Python: 3.12-slim   â”‚   â”‚
â”‚  â”‚                         â”‚              â”‚                      â”‚   â”‚
â”‚  â”‚  Health: wget :5173     â”‚              â”‚  Health: curl :8000  â”‚   â”‚
â”‚  â”‚  Resources: 2CPU, 2GB   â”‚              â”‚  Resources: 2CPU, 1GBâ”‚   â”‚
â”‚  â”‚                         â”‚              â”‚                      â”‚   â”‚
â”‚  â”‚  Features:              â”‚              â”‚  Features:           â”‚   â”‚
â”‚  â”‚  - Hot Module Reload    â”‚              â”‚  - Auto migrations   â”‚   â”‚
â”‚  â”‚  - Live code editing    â”‚              â”‚  - Auto reload       â”‚   â”‚
â”‚  â”‚  - Runtime config       â”‚              â”‚  - Config API        â”‚   â”‚
â”‚  â”‚                         â”‚              â”‚  - REST API          â”‚   â”‚
â”‚  â”‚  Volumes:               â”‚              â”‚                      â”‚   â”‚
â”‚  â”‚  - src/ (bind mount)    â”‚              â”‚  Volumes:            â”‚   â”‚
â”‚  â”‚  - node_modules (named) â”‚              â”‚  - code (bind mount) â”‚   â”‚
â”‚  â”‚                         â”‚              â”‚  - media (named)     â”‚   â”‚
â”‚  â”‚                         â”‚              â”‚  - static (named)    â”‚   â”‚
â”‚  â”‚                         â”‚              â”‚  - logs (bind mount) â”‚   â”‚
â”‚  â”‚                         â”‚              â”‚                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                    â”‚                  â”‚
â”‚                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                                     â”‚                           â”‚     â”‚
â”‚                                     â–¼                           â–¼     â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚                        â”‚                     â”‚   â”‚                  â”‚â”‚
â”‚                        â”‚  PostgreSQL         â”‚   â”‚  Redis           â”‚â”‚
â”‚                        â”‚  (app-db)           â”‚   â”‚  (app-redis)     â”‚â”‚
â”‚                        â”‚                     â”‚   â”‚                  â”‚â”‚
â”‚                        â”‚  Image: postgres:15 â”‚   â”‚  Image: redis:7  â”‚â”‚
â”‚                        â”‚  Port: 5432         â”‚   â”‚  Port: 6379      â”‚â”‚
â”‚                        â”‚                     â”‚   â”‚                  â”‚â”‚
â”‚                        â”‚  Health: pg_isready â”‚   â”‚  Health: ping    â”‚â”‚
â”‚                        â”‚  Resources:         â”‚   â”‚  Resources:      â”‚â”‚
â”‚                        â”‚    1CPU, 512MB      â”‚   â”‚    0.5CPU, 256MB â”‚â”‚
â”‚                        â”‚                     â”‚   â”‚                  â”‚â”‚
â”‚                        â”‚  Volume:            â”‚   â”‚  Volume:         â”‚â”‚
â”‚                        â”‚  - postgres_data    â”‚   â”‚  - redis_data    â”‚â”‚
â”‚                        â”‚                     â”‚   â”‚                  â”‚â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Service Startup Sequence

```
Time    Service          Status              Action
â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
T+0s    db               starting            PostgreSQL initializing
        redis            starting            Redis initializing

T+5s    db               healthy             pg_isready returns OK
        redis            healthy             redis-cli ping returns PONG

T+10s   backend          starting            Waiting for db/redis health checks
                                            Running migrations
                                            Starting Django dev server

T+40s   backend          healthy             Health endpoint responds 200

T+45s   frontend         starting            Waiting for backend health check
                                            npm run dev starting
                                            Vite dev server initializing

T+75s   frontend         healthy             Vite responds to health check

T+80s   proxy            starting            Waiting for frontend/backend health
                                            nginx starting

T+90s   proxy            healthy             All services ready!
                                            Application accessible at http://localhost/
```

## Data Flow - API Request

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Browser                                                   â”‚
â”‚  http://localhost/api/v1/users/                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ GET /api/v1/users/
                     â”‚ Host: localhost
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Nginx Reverse Proxy (app-proxy)                               â”‚
â”‚  - Receives request on port 80                                 â”‚
â”‚  - Matches location /api/                                      â”‚
â”‚  - Proxies to upstream backend                                 â”‚
â”‚  - Adds headers: X-Real-IP, X-Forwarded-For, etc.             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ proxy_pass http://backend:8000/api/v1/users/
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Django Backend (app-backend)                                  â”‚
â”‚  - Receives request on port 8000                               â”‚
â”‚  - Django routing matches /api/v1/users/                       â”‚
â”‚  - DRF view processes request                                  â”‚
â”‚  - Queries database if needed                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ SQL Query (if needed)
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL Database (app-db)                                  â”‚
â”‚  - Executes query                                              â”‚
â”‚  - Returns results                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ JSON Response
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Django Backend (app-backend)                                  â”‚
â”‚  - Serializes data to JSON                                     â”‚
â”‚  - Adds response headers                                       â”‚
â”‚  - Returns HTTP 200 response                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ HTTP 200 + JSON
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Nginx Reverse Proxy (app-proxy)                               â”‚
â”‚  - Receives backend response                                   â”‚
â”‚  - Adds security headers                                       â”‚
â”‚  - Applies gzip compression                                    â”‚
â”‚  - Forwards to browser                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ HTTP 200 + JSON (compressed)
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Browser                                                  â”‚
â”‚  - Receives response                                           â”‚
â”‚  - Updates UI                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow - Frontend Access

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Browser                                                   â”‚
â”‚  http://localhost/                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ GET /
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Nginx Reverse Proxy (app-proxy)                               â”‚
â”‚  - Matches location / (catch-all)                              â”‚
â”‚  - Proxies to upstream frontend                                â”‚
â”‚  - Supports WebSocket upgrade for HMR                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ proxy_pass http://frontend:5173/
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vite Dev Server (app-frontend)                                â”‚
â”‚  - Serves index.html                                           â”‚
â”‚  - Serves bundled JavaScript                                   â”‚
â”‚  - Establishes WebSocket for HMR                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ HTML + JS + WebSocket
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Browser                                                  â”‚
â”‚  - Renders React application                                   â”‚
â”‚  - React Router displays onboarding page at root URL (/)       â”‚
â”‚    (Feature #14: Onboarding is the main page)                  â”‚
â”‚  - Connects WebSocket for HMR                                  â”‚
â”‚  - Fetches runtime config from /api/v1/config/frontend/       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ GET /api/v1/config/frontend/
                     â”‚ (goes through proxy to backend)
                     â”‚
                     â–¼
                [Runtime config loaded, app ready]
```

## Volume Mounting Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Docker Volumes                              â”‚
â”‚                                                                  â”‚
â”‚  Named Volumes (Docker-managed, portable)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  app-postgres-data     â†’ /var/lib/postgresql/data (db)    â”‚ â”‚
â”‚  â”‚  app-redis-data        â†’ /data (redis)                    â”‚ â”‚
â”‚  â”‚  app-backend-media     â†’ /app/media (backend)             â”‚ â”‚
â”‚  â”‚  app-backend-static    â†’ /app/staticfiles (backend)       â”‚ â”‚
â”‚  â”‚  app-frontend-node-modules â†’ /app/node_modules (frontend) â”‚ â”‚
â”‚  â”‚  app-proxy-logs        â†’ /var/log/nginx (proxy)           â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  Bind Mounts (Host filesystem, for live editing)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  ./backend             â†’ /app (backend)                   â”‚ â”‚
â”‚  â”‚  ./backend/logs        â†’ /app/logs (backend)              â”‚ â”‚
â”‚  â”‚  ./frontend/src        â†’ /app/src (frontend)              â”‚ â”‚
â”‚  â”‚  ./frontend/public     â†’ /app/public (frontend)           â”‚ â”‚
â”‚  â”‚  ./nginx/nginx.conf    â†’ /etc/nginx/nginx.conf (proxy)    â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Benefits:
  âœ… Named volumes persist data across container restarts
  âœ… Bind mounts enable live code editing without rebuilds
  âœ… Separate volumes prevent data loss when rebuilding containers
```

## Resource Allocation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Resource Limits & Reservations                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Service     â”‚  CPU Limit  â”‚  CPU Reserve  â”‚  Mem Limit  â”‚ Mem Reserve â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  proxy       â”‚  0.5 CPU    â”‚  0.25 CPU     â”‚  256 MB     â”‚  128 MB     â”‚
â”‚  frontend    â”‚  2.0 CPUs   â”‚  1.0 CPU      â”‚  2048 MB    â”‚  512 MB     â”‚
â”‚  backend     â”‚  2.0 CPUs   â”‚  0.5 CPU      â”‚  1024 MB    â”‚  512 MB     â”‚
â”‚  db          â”‚  1.0 CPU    â”‚  0.5 CPU      â”‚  512 MB     â”‚  256 MB     â”‚
â”‚  redis       â”‚  0.5 CPU    â”‚  0.25 CPU     â”‚  256 MB     â”‚  128 MB     â”‚
â”‚  celery*     â”‚  1.0 CPU    â”‚  0.25 CPU     â”‚  512 MB     â”‚  256 MB     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  TOTAL       â”‚  7.0 CPUs   â”‚  2.75 CPUs    â”‚  4608 MB    â”‚  1792 MB    â”‚
â”‚                                                                  â”‚
â”‚  * celery is optional (profile: with-celery)                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Typical Resource Usage (Development):
  CPU: 15-25% (idle: <10%)
  Memory: 2-3 GB (idle: ~1.5 GB)

Resource Strategy:
  - Limits prevent runaway processes
  - Reservations ensure minimum allocation
  - Frontend gets most memory (Vite compilation)
  - Backend gets most CPU (Django processing)
```

## Health Check Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Health Check System                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Every 10-30 seconds (depending on service):

  Docker Engine
       â”‚
       â”œâ”€â†’ db:           pg_isready -U postgres -d backend_db
       â”‚                 â””â”€â†’ Returns: healthy/unhealthy
       â”‚
       â”œâ”€â†’ redis:        redis-cli ping
       â”‚                 â””â”€â†’ Returns: healthy/unhealthy
       â”‚
       â”œâ”€â†’ backend:      curl -f http://localhost:8000/api/v1/health/
       â”‚                 â””â”€â†’ Checks: Database connectivity, Redis, etc.
       â”‚                 â””â”€â†’ Returns: healthy/unhealthy
       â”‚
       â”œâ”€â†’ frontend:     wget --spider http://localhost:5173
       â”‚                 â””â”€â†’ Returns: healthy/unhealthy
       â”‚
       â””â”€â†’ proxy:        wget --spider http://localhost/health
                         â””â”€â†’ Returns: healthy/unhealthy

If unhealthy for 3 consecutive checks â†’ Container restarts automatically

Service Dependencies:
  - backend waits for db + redis to be healthy
  - frontend waits for backend to be healthy
  - proxy waits for frontend + backend to be healthy
```

## Network Isolation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Host Network                           â”‚
â”‚                                                                â”‚
â”‚  Exposed Ports (accessible from host):                         â”‚
â”‚    - 80:80         (proxy - UNIFIED ENTRY POINT)              â”‚
â”‚    - 5432:5432     (db - for pgAdmin, etc.)                   â”‚
â”‚    - 6379:6379     (redis - for Redis Desktop Manager, etc.)  â”‚
â”‚    - 5173:5173     (frontend - direct access for debugging)   â”‚
â”‚    - 8000:8000     (backend - direct access for debugging)    â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ Port mapping
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Docker Bridge Network (app-network)               â”‚
â”‚                                                                â”‚
â”‚  Internal Communication (DNS-based):                           â”‚
â”‚    - proxy can reach:    frontend:5173, backend:8000          â”‚
â”‚    - frontend can reach: backend:8000 (if needed)             â”‚
â”‚    - backend can reach:  db:5432, redis:6379                  â”‚
â”‚    - celery can reach:   db:5432, redis:6379                  â”‚
â”‚                                                                â”‚
â”‚  Network Features:                                             â”‚
â”‚    âœ… Automatic DNS resolution (service name â†’ IP)            â”‚
â”‚    âœ… Network isolation from other Docker networks            â”‚
â”‚    âœ… Can't access other containers outside this network      â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Production Note:
  In production (Story 12.5), only port 80/443 should be exposed.
  Database and Redis should NOT be accessible from outside.
```

---

**Visual Architecture Summary**

This architecture provides:
- âœ… **Unified entry point** via nginx reverse proxy
- âœ… **Automatic service discovery** via Docker DNS
- âœ… **Health-based dependency management**
- âœ… **Data persistence** via named volumes
- âœ… **Live development** via bind mounts
- âœ… **Resource management** via limits/reservations
- âœ… **Network isolation** via bridge network

All accessible with a single command: `./docker-dev.sh start` ğŸš€
